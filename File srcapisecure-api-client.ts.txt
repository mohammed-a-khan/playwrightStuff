# features/api/khan-asset-api.feature

Feature: Khan Asset API
  As an API consumer
  I want to retrieve asset information for specific deals
  So that I can process and report on deal assets

  Background:
    Given I have initialized the Khan Asset API client

  @api @smoke
  Scenario: Retrieve assets using template file
    When I request assets using the "standard-asset-request" template
    Then the API should return a successful response
    And the response should contain asset layouts
    And the response should have no system errors
    And the response message ID should be "999"
    And the response time should be acceptable

  @api @regression
  Scenario: Retrieve assets with specific parameters
    When I request assets with message ID "999", deal ID 2223, and report date "2024-03-31"
    Then the API should return a successful response
    And the response should contain asset layouts
    And the response should have no system errors
    And the response message ID should be "999"
    And the response should contain at least 1 asset layout

  @api @regression
  Scenario: Retrieve assets with parameter table
    When I request assets with the following details:
      | messageId  | 999           |
      | dealId     | 2223          |
      | reportDate | 2024-03-31    |
    Then the API should return a successful response
    And the response should contain asset layouts
    And the response should have no system errors
    And the response message ID should be "999"
    And I save the response to file "asset-response.json"

  @api @performance
  Scenario: Asset API performance check
    When I request assets using the "standard-asset-request" template
    Then the response time should be acceptable
    And the API should return a successful response

# .env.sit
# Environment-specific configuration for SIT environment

# Base URLs
API_BASE_URL=https://khanapi-sit.indias.net/api/v1
BASE_URL=https://khanapi-sit.indias.net

# Khan API Certificate settings
KHAN_API_CERT_PATH=./certs/khanapicert.pfx
KHAN_API_CERT_PASSPHRASE=khanapipwd

# Generic certificate fallback (if specific ones not provided)
PFX_CERT_PATH=./certs/khanapicert.pfx
PFX_CERT_PASSPHRASE=khanapipwd

# Proxy settings
PROXY_URL=http://167.221.23.8:8080

# Timeouts and retry settings
DEFAULT_TIMEOUT=60000
API_RETRY_ATTEMPTS=3
API_RETRY_DELAY=1000
MAX_RESPONSE_TIME=5000

# Debug settings
API_DEBUG=true
API_DEBUG_HEADERS=true
API_DEBUG_BODY_LENGTH=2000
REJECT_UNAUTHORIZED=true

# Test data settings
TEST_DATA_CLEANUP=true
