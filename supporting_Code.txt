// File: src/scripts/generate-report.js
const reporter = require('cucumber-html-reporter');
const fs = require('fs');
const path = require('path');

// Check if the JSON report exists
const jsonReportPath = path.join(__dirname, '../../reports/json/cucumber-report.json');
if (!fs.existsSync(jsonReportPath)) {
  console.error(`Error: JSON report not found at ${jsonReportPath}`);
  console.error('Make sure to run tests first with the --format json:reports/json/cucumber-report.json option.');
  process.exit(1);
}

// Options for the reporter
const options = {
  theme: 'bootstrap',
  jsonFile: jsonReportPath,
  output: path.join(__dirname, '../../reports/html/cucumber-report.html'),
  reportSuiteAsScenarios: true,
  scenarioTimestamp: true,
  launchReport: false,
  metadata: {
    "App Version": "1.0.0",
    "Test Environment": process.env.NODE_ENV || 'default',
    "Browser": "Chrome",
    "Platform": process.platform,
    "Parallel": "Scenarios",
    "Executed": "Remote"
  }
};

// Generate the report
reporter.generate(options);

console.log(`
Report generated successfully at:
${options.output}
`);
